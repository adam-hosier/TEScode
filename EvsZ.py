
import numpy as np 
import pylab as plt 
import os 
import pandas as pd
import matplotlib.colors as mcolors
from scipy.stats import binned_statistic_2d
from scipy import stats
from fit_utils import MultiPeakGaussian
from lmfit import minimize, Parameters, report_fit, Model, Parameter
from lmfit.models import GaussianModel
from lmfit.models import SplitLorentzianModel 

xdat = np.arange(18, 93)
xdat2 = np.arange(19, 93)
xdat3 = np.arange(20, 93)
#energies in cm-1  NON ISOTOPE ABUND CORRECTED
ydat = [140095,
    157157.8,
    174217.1,
    191290,
    208387.2,
    225519.3,
    242695.6,
    259920.4,
    277204.4,
    294551.5,
    311966.7,
    329457.9,
    347028.7,
    364684.8,
    382431,
    400276.4,
    418221.3,
    436275.4,
    454438.7,
    472720.7,
    491127.2,
    509660.6,
    528328.5,
    547130.1,
    566074.5,
    585175,
    604428.3,
    623845.7,
    643431.1,
    663191,
    683120.9,
    703249.1,
    723561.9,
    744070.7,
    764768.9,
    785717,
    806857.6,
    828233.9,
    849833.5,
    871678.7,
    893768.8,
    916121.9,
    938728.8,
    961594.5,
    984707.9,
    1008155.2,
    1031870.5,
    1055917.4,
    1080307.2,
    1104844.7,
    1129988.8,
    1155245.8,
    1180735.3,
    1206917.8,
    1233268.2,
    1260051.7,
    1287068.5,
    1314672.2,
    1342562.4,
    1370845.3,
    1399575.7,
    1428702.9,
    1458176.3,
    1488149.2,
    1518511.8,
    1549260.6,
    1580557.1,
    1612033.3,
    1643736.1,
    1676270.3,
    1709055.3,
    1742362.1,
    1774385.8,
    1809911.5,
    1841739.8]


LiLikeE = [24578337.34,
    27519585.35,
    30629236,
    33907765,
    37355678.54,
    40973513.37,
    44761836.7,
    48721246.31,
    52852370.46,
    57155867.95,
    61632428.06,
    66282770.64,
    71107646,
    76107835.01,
    81284149.02,
    86637429.94,
    92168550.14,
    97878412.56,
    103767950.6,
    109838128.3,
    116089940,
    122524410.7,
    129142596,
    135945581.8,
    142934484.7,
    150110451.7,
    157474660.4,
    165028318.8,
    172772665.6,
    180708969.8,
    188838531.1,
    197162679.6,
    205682776,
    214400211.4,
    223316407.6,
    232432816.7,
    241750921.4,
    251272235.1,
    260998301.3,
    270930694.5,
    281071019.4,
    291420911.3,
    301982036,
    312756089.8,
    323744799.7,
    334949922.8,
    346373247.3,
    358016591.3,
    369881803.9,
    381970764.5,
    394285382.9,
    406827599.8,
    419599386,
    432602743,
    445839702.9,
    459312328.2,
    473022711.9,
    486972977.6,
    501165279.3,
    515601801.6,
    530284759.7,
    545216399.1,
    560398996,
    575834857.1,
    591526319.4,
    607475750.8,
    623685549.3,
    640158143.8,
    656895993.4,
    673901587.9,
    691177447.6,
    708726123.2,
    726550196,
    744652277.9,
    763035011.1]


D2Energy = [142804.6,
    160916.1,
    179288.1,
    197978.1,
    217039.2,
    236528.8,
    256504.4,
    277023.9,
    298152.0,
    319951.9,
    342491.0,
    365841.4,
    390076.4,
    415273.4,
    441514.3,
    468886.3,
    497474.3,
    527375.4,
    558680.7,
    591495.2,
    625925.8,
    662075.5,
    700063.9,
    740002.5,
    782018.0,
    826248.2,
    872816.6,
    921868.4,
    973546.4,
    1028001.8,
    1085380.1,
    1145868.2,
    1209609.5,
    1276790.2,
    1347577.2,
    1422216.5,
    1500839.2,
    1583686.1,
    1670951.8,
    1762872.6,
    1859670.2,
    1961594.5,
    2068878.0,
    2181773.8,
    2300535.2,
    2425518.1,
    2556938.6,
    2695156.3,
    2840491.0,
    2993054.6,
    3153660.9,
    3322141.3,
    3498979.8,
    3685038.6,
    3880149.8,
    4085007.5,
    4299834.6,
    4525446.9,
    4761991.2,
    5010069.0,
    5270247.0,
    5543006.2,
    5828855.5,
    6128532.9,
    6442541.5,
    6771518.7,
    7116309.4,
    7477220.7,
    7855047.5,
    8251231.4,
    8665958.4,
    9100383.8,
    9553407.5,
    10031340.80,
    10527110.2]


#energy uncertainties in cm-1
yunc = [2.7,
    3.2,
    4.1,
    4.7,
    5.2,
    5.5,
    5.9,
    6.2,
    6.6,
    7.1,
    7.5,
    7.9,
    8.6,
    9.3,
    10.2,
    10.8,
    11.8,
    12.7,
    13.8,
    14.9,
    16,
    17.4,
    18.5,
    20,
    21.5,
    23.4,
    25,
    26.4,
    28.7,
    29.8,
    31.8,
    33.9,
    35.8,
    39.9,
    42.5,
    42.8,
    48.4,
    47.8,
    50.6,
    53.4,
    56.4,
    59.5,
    62.7,
    76,
    87.6,
    86.9,
    93.2,
    99.7,
    135,
    137,
    151,
    133,
    145,
    154,
    167,
    180,
    223,
    214,
    230,
    250,
    275,
    175,
    170,
    175,
    186,
    199,
    464,
    508,
    557,
    614,
    685,
    739,
    324,
    893,
    332]

#fraction of nuclear contribution to total energy uncertainty
nucFrac = [0.001877333,
    0.006488281,
    0.001878049,
    0.016031915,
    0.003388846,
    0.0113,
    0.032640169,
    0.035616935,
    0.00223,
    0.029287887,
    0.019712,
    0.008128861,
    0.060717442,
    0.072150538,
    0.07872549,
    0.003483333,
    0.096016949,
    0.103503937,
    0.112789855,
    0.121442953,
    0.0938025,
    0.005474713,
    0.002990811,
    0.0095535,
    0.020751628,
    0.181452991,
    0.1958,
    0.12625,
    0.220383275,
    0.009597315,
    0.010308176,
    0.081769912,
    0.005868715,
    0.299122807,
    0.320941176,
    0.077462617,
    0.359318182,
    0.007985356,
    0.008456522,
    0.008981273,
    0.009498227,
    0.01007563,
    0.010684211,
    0.495723684,
    0.609143836,
    0.541772152,
    0.564753219,
    0.586960883,
    0.7788,
    0.75819708,
    0.784890066,
    0.671992481,
    0.707633793,
    0.716071429,
    0.734431138,
    0.754111111,
    0.827466368,
    0.779766355,
    0.803717391,
    0.81906,
    0.8236,
    0.314323429,
    0.196175294,
    0.034961143,
    0.036370968,
    0.188050251,
    0.892327586,
    0.902194882,
    0.911795332,
    0.91269544,
    0.903686131,
    0.923985115,
    0.187475309,
    0.931366181,
    0.111590361]


nonNuc = [2.699995242,
    3.199932643,
    4.09999277,
    4.699395959,
    5.199970141,
    5.499648841,
    5.89685629,
    6.196066197,
    6.599983589,
    7.096954226,
    7.498542747,
    7.899738986,
    8.584132949,
    9.275761909,
    10.16834259,
    10.79993448,
    11.74548045,
    12.63178886,
    13.71194033,
    14.78971635,
    15.9294532,
    17.39973924,
    18.49991726,
    19.99908729,
    21.49537023,
    23.0115511,
    24.51609624,
    26.18875925,
    27.99436327,
    29.79862755,
    31.79831045,
    33.78647682,
    35.79938349,
    38.07316345,
    40.25171301,
    42.67139701,
    45.16761139,
    47.79847597,
    50.59819069,
    53.39784625,
    56.39745584,
    59.49697975,
    62.69642122,
    66.00450269,
    69.47203523,
    73.04165661,
    76.91421699,
    80.71864469,
    84.68176283,
    89.32748665,
    93.56489118,
    98.49420986,
    102.4540095,
    107.4961598,
    113.3400966,
    118.214434,
    125.2179076,
    133.9791144,
    136.8525812,
    143.4269667,
    155.9720485,
    166.1302921,
    166.6967031,
    174.8930177,
    185.8769345,
    195.4497222,
    209.4442131,
    219.1149488,
    228.7292353,
    250.905249,
    293.3139093,
    282.6146128,
    318.2552583,
    325.1268612,
    329.9264247]


nonNuc2 = [2.699996068,
    3.199944333,
    4.099994024,
    4.699500798,
    5.199975323,
    5.499709788,
    5.897402012,
    6.196749102,
    6.599986438,
    7.097482926,
    7.498795679,
    7.899784287,
    8.586888838,
    9.27997306,
    10.17384391,
    10.79994585,
    11.75496065,
    12.64365355,
    13.72726393,
    14.80891539,
    15.94171925,
    17.39978449,
    18.49993162,
    19.99924569,
    21.49617381,
    23.07943673,
    24.60076218,
    26.22554289,
    28.11809915,
    29.79886575,
    31.79860368,
    33.80620653,
    35.79949049,
    38.39645166,
    40.65083025,
    42.69374432,
    45.7449877,
    47.79874048,
    50.59850471,
    53.39822005,
    56.3978974,
    59.49750394,
    62.69704235,
    67.84495191,
    72.94203109,
    75.62916104,
    79.97885658,
    84.31992647,
    95.3386784,
    99.25711612,
    105.7933385,
    105.2969017,
    111.0136395,
    116.9014008,
    124.3251785,
    131.0436568,
    146.9317444,
    150.94075,
    157.0324728,
    166.8777322,
    182.2914973,
    167.7033093,
    167.2746809,
    174.9115895,
    185.8982988,
    196.0704965,
    271.3282882,
    290.631687,
    311.5800218,
    342.719561,
    390.5604147,
    400.9868296,
    319.259693,
    475.1439677,
    330.287235]


####### Isotope abundance corrected values 

xIC = [18,
    19,
    20,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    28,
    29,
    30,
    31,
    32,
    33,
    34,
    35,
    36,
    37,
    38,
    39,
    40,
    41,
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    49,
    50,
    51,
    52,
    53,
    54,
    55,
    56,
    57,
    58,
    59,
    60,
    62,
    63,
    64,
    65,
    66,
    67,
    68,
    69,
    70,
    71,
    72,
    73,
    74,
    75,
    76,
    77,
    78,
    79,
    80,
    82,
    83,
    90,
    92]

yuncIC = [2.699995744,
    3.199933137,
    4.099993305,
    4.699397469,
    5.199971206,
    5.499651547,
    5.896874871,
    16.11699697,
    6.599988369,
    24.22713087,
    7.498543741,
    7.899750484,
    8.584149228,
    9.275791297,
    10.16836218,
    77.81392365,
    11.74556172,
    12.63190951,
    13.71211905,
    14.78995395,
    15.92963591,
    17.40002673,
    18.50002692,
    19.99938037,
    21.49572337,
    23.4,
    24.51738854,
    26.19000585,
    27.99672419,
    29.80133873,
    31.80253799,
    33.78994972,
    37.01769605,
    38.07805629,
    40.25918427,
    42.74117761,
    45.19805042,
    47.83071408,
    50.63680268,
    63.07495559,
    56.40590331,
    59.57243999,
    62.72530137,
    69.59988603,
    73.22071957,
    77.04426571,
    193.2273614,
    91.54506885,
    100.31411,
    93.71994757,
    98.6927051,
    103.1420961,
    126.6915601,
    113.6016805,
    118.5742434,
    125.3919502,
    145.8409025,
    136.9442762,
    457.5711865,
    156.4291653,
    167.213518,
    167.647212,
    186.1003643,
    705.692628,
    369.7882837,
    335.561501]

ydatIC = [140095.000425,
    157157.7781,
    174217.0973,
    191289.9947,
    208387.2123,
    225519.3244,
    242695.4985,
    259920.3974,
    277204.4021,
    294551.4694,
    311966.3826,
    329457.9797,
    347028.828,
    364684.738,
    382431.2398,
    400276.5231,
    418221.9502,
    436275.2704,
    454439.8869,
    472722.1051,
    491127.8515,
    509660.6433,
    528327.6203,
    547129.7526,
    566076.8272,
    585175,
    604428.9916,
    623846.4575,
    643429.8586,
    663189.406,
    683123.3215,
    703249.7764,
    723564.1756,
    744075.1496,
    764786.4909,
    785717.548,
    806858.6581,
    828234.9063,
    849835.0448,
    871678.703,
    893767.1779,
    916122.4995,
    938709.6198,
    984694.8379,
    1008119.121,
    1031811.199,
    1055958.896,
    1080157.765,
    1104855.074,
    1129789.49,
    1155191.2,
    1180757.091,
    1206668.977,
    1233157.928,
    1259925.69,
    1287052.274,
    1314626.735,
    1342459.377,
    1370845.997,
    1399536.308,
    1428702.445,
    1458224.22,
    1518562.651,
    1549327.96,
    1774623.246,
    1841791.5]

nucuncIC = [0.001646447,
    0.001779257,
    0.002096223,
    0.0037675,
    0.0033286,
    0.005455527,
    0.01480364,
    14.8783855,
    0.007943256,
    23.16435,
    0.003859917,
    0.013477982,
    0.016717661,
    0.023349351,
    0.019961777,
    77.060808,
    0.043693012,
    0.055209,
    0.070008475,
    0.083834497,
    0.076296035,
    0.100023,
    0.063698663,
    0.108273,
    0.12321452,
    4.246,
    0.251725375,
    0.25553,
    0.363579975,
    0.401977862,
    0.518532069,
    0.48444396,
    9.418809011,
    0.610406027,
    0.775575856,
    2.44134,
    1.65850615,
    1.75582,
    1.977089699,
    33.57260847,
    0.97616754,
    2.9975,
    1.903207337,
    4.21668786,
    5.117633664,
    4.47460662,
    175.56,
    34.77784748,
    45.6456,
    5.388850667,
    6.25625,
    11.89402888,
    67.0472,
    7.70482394,
    9.23032,
    6.604301,
    57.61220124,
    5.010568717,
    434.51133,
    11.95005632,
    19.00228,
    17.82685768,
    9.116514,
    678.08664,
    188.3002,
    61.23785808]

nonnucuncIC = [2.699995242,
    3.199932643,
    4.09999277,
    4.699395959,
    5.199970141,
    5.499648841,
    5.89685629,
    6.196066197,
    6.599983589,
    7.096954226,
    7.498542747,
    7.899738986,
    8.584132949,
    9.275761909,
    10.16834259,
    10.79993448,
    11.74548045,
    12.63178886,
    13.71194033,
    14.78971635,
    15.9294532,
    17.39973924,
    18.49991726,
    19.99908729,
    21.49537023,
    23.0115511,
    24.51609624,
    26.18875925,
    27.99436327,
    29.79862755,
    31.79831045,
    33.78647682,
    35.79938349,
    38.07316345,
    40.25171301,
    42.67139701,
    45.16761139,
    47.79847597,
    50.59819069,
    53.39784625,
    56.39745584,
    59.49697975,
    62.69642122,
    69.47203523,
    73.04165661,
    76.91421699,
    80.71864469,
    84.68176283,
    89.32748665,
    93.56489118,
    98.49420986,
    102.4540095,
    107.4961598,
    113.3400966,
    118.214434,
    125.2179076,
    133.9791144,
    136.8525812,
    143.4269667,
    155.9720485,
    166.1302921,
    166.6967031,
    185.8769345,
    195.4497222,
    318.2552583,
    329.9264247]


Sens = [-0.58,
    -0.76,
    -1,
    -1.37,
    -1.78,
    -2.26,
    -2.87,
    -3.65,
    -4.46,
    -5.56,
    -6.72,
    -8.34,
    -10.1,
    -12.2,
    -14.6,
    -17.1,
    -20.6,
    -23.9,
    -28.3,
    -32.9,
    -37.9,
    -43.3,
    -50.3,
    -57.9,
    -67.6,
    -77.2,
    -89,
    -101,
    -115,
    -130,
    -149,
    -168,
    -191,
    -217,
    -248,
    -274,
    -310,
    -347,
    -389,
    -436,
    -487,
    -545,
    -609,
    -685,
    -770,
    -856,
    -957,
    -1064,
    -1180,
    -1330,
    -1456,
    -1625,
    -1829,
    -2005,
    -2230,
    -2468,
    -2750,
    -3034,
    -3361,
    -3723,
    -4118,
    -4546,
    -5053,
    -5562,
    -6150,
    -6804,
    -7528,
    -8333,
    -9234,
    -10189,
    -11255,
    -12415,
    -13805,
    -15122,
    -16840]

S_SZ1 = [0.762913907,
    0.755,
    0.729927007,
    0.769662921,
    0.787610619,
    0.787456446,
    0.78630137,
    0.81838565,
    0.802158273,
    0.827380952,
    0.805755396,
    0.825742574,
    0.827868852,
    0.835616438,
    0.85380117,
    0.830097087,
    0.861924686,
    0.844522968,
    0.860182371,
    0.868073879,
    0.875288684,
    0.86083499,
    0.868739206,
    0.856508876,
    0.875647668,
    0.86741573,
    0.881188119,
    0.87826087,
    0.884615385,
    0.872483221,
    0.886904762,
    0.879581152,
    0.880184332,
    0.875,
    0.905109489,
    0.883870968,
    0.893371758,
    0.892030848,
    0.892201835,
    0.895277207,
    0.893577982,
    0.894909688,
    0.889051095,
    0.88961039,
    0.89953271,
    0.89446186,
    0.89943609,
    0.901694915,
    0.887218045,
    0.913461538,
    0.896,
    0.888463641,
    0.912219451,
    0.899103139,
    0.90356564,
    0.897454545,
    0.906394199,
    0.902707528,
    0.902766586,
    0.90407965,
    0.905851298,
    0.899663566,
    0.908486156,
    0.904390244,
    0.903880071,
    0.903825717,
    0.903396136,
    0.902425818,
    0.906271469,
    0.905286539,
    0.90656464,
    0.899311844,
    0.912908345,
    0.897980998]

S_SZ2 = [0.576,
    0.551094891,
    0.561797753,
    0.60619469,
    0.620209059,
    0.619178082,
    0.643497758,
    0.65647482,
    0.663690476,
    0.666666667,
    0.665346535,
    0.683606557,
    0.691780822,
    0.713450292,
    0.708737864,
    0.715481172,
    0.727915194,
    0.726443769,
    0.746701847,
    0.759815242,
    0.753479125,
    0.747841105,
    0.74408284,
    0.75,
    0.759550562,
    0.764356436,
    0.773913043,
    0.776923077,
    0.771812081,
    0.773809524,
    0.780104712,
    0.774193548,
    0.77016129,
    0.791970803,
    0.8,
    0.78962536,
    0.796915167,
    0.79587156,
    0.798767967,
    0.8,
    0.799671593,
    0.795620438,
    0.790909091,
    0.800233645,
    0.804597701,
    0.804511278,
    0.811016949,
    0.8,
    0.81043956,
    0.818461538,
    0.796063423,
    0.810473815,
    0.820179372,
    0.812398703,
    0.810909091,
    0.813447594,
    0.818208866,
    0.814934193,
    0.816172899,
    0.818961725,
    0.814961409,
    0.817331895,
    0.821626016,
    0.817460317,
    0.816950053,
    0.816512661,
    0.815247997,
    0.817842772,
    0.820435362,
    0.820700765,
    0.815284317,
    0.820989287,
    0.819774347]

###################
def poly3(x, a, b, c, d, e, f, g):
    return a*x**3+ + b*x**2 + c*x + d + e*x**4 + f*x**5 + g*x**6



mod = Model(poly3) 
params = Parameters() 
params.add('a', value=0.000000, vary=True)
params.add('b', value=0.00001, vary=True)
params.add('c', value=0.0001, vary=True)
params.add('d', value=0, vary=True)
params.add('e', value=0, vary=True)
params.add('f', value=0, vary=True)
params.add('g', value=0, vary=True)

fit = mod.fit(nonnucuncIC, params, x=xIC, weights=None, nfev=1e7)
params.update(fit.params)
xplot = np.linspace(np.min(xdat), np.max(xdat), num=1000)
yplot = mod.eval(params=params, x=xplot)

#params.pretty_print()
# figs, axs = plt.subplots(nrows=4, ncols=1, sharex=True)
# axs[1].plot(xdat, yunc)
# axs[0].set_title('Na-like Isoelectronic Sequence D1 Energies')
# #axs[0].set_title('Na-like Isoelectronic Sequence D1 Energies')
# axs[1].set_ylabel('Theoretical Uncertainty [cm-1]')

# axs[2].plot(xdat, nonNuc)
# axs[2].set_ylabel('QED error [cm-1]')



# axs[3].plot(xdat, nucFrac)

# axs[3].set_ylabel('Fractional Nuclear Contribution')

# axs[0].scatter(xdat, ydat)
# axs[0].errorbar(xdat, ydat, yerr=yunc, ls='none')
# axs[0].set_ylabel('Energy [cm-1]')
# axs[3].set_xlabel('Z')
# plt.minorticks_on()
# plt.show()

plt.figure() 
plt.scatter(xdat, ydat, s=4, label='Na-like D1')
plt.scatter(xdat, D2Energy, s=4, label='Na-like D2')
#plt.scatter(xdat, LiLikeE, s=4, label='Li-like transition')
plt.legend()
plt.xlabel('Z')
plt.ylabel('Transition Energy [cm-1]')
plt.minorticks_on()
plt.fill_between(xdat,y1 = 3333333.33, y2=333333.33, alpha=0.15)
plt.xlim(left=np.min(xdat), right=np.max(xdat))
plt.ylim(bottom=0, top=6*10**6)
plt.show()

### 3nm ==  3333333.33 cm-1 
### 30 nm == 333333.33 cm-1

mod2 = Model(poly3) 
params2 = Parameters() 
params2.add('a', value=0.000000, vary=True)
params2.add('b', value=0.00001, vary=True)
params2.add('c', value=0.0001, vary=True)
params2.add('d', value=0, vary=True)
params2.add('e', value=0, vary=True)
params2.add('f', value=0, vary=True)
params2.add('g', value=0, vary=True)

fit2 = mod2.fit(Sens, params2, x=xdat, weights=None, nfev=1e7)
params2.update(fit2.params)
xplot2= np.linspace(np.min(xdat), np.max(xdat), num=1000)
yplot2 = mod2.eval(params=params2, x=xplot2)

plt.figure() 
plt.scatter(xdat, Sens, s=3, c='b')
plt.plot(xplot2, yplot2, c='r')
plt.ylabel('Nuclear sensitivity coefficient [cm-1/fm]')
plt.xlabel('Z')
plt.minorticks_on()
plt.show()
plt.close()


mod3 = Model(poly3) 
params3 = Parameters() 
params3.add('a', value=0.000000, vary=True)
params3.add('b', value=0.00001, vary=True)
params3.add('c', value=0.0001, vary=True)
params3.add('d', value=0, vary=True)
params3.add('e', value=0, vary=True)
params3.add('f', value=0, vary=False)
params3.add('g', value=0, vary=False)

fit3 = mod3.fit(S_SZ1, params3, x=xdat2, weights=None, nfev=1e7)
params3.update(fit3.params)
xplot3= np.linspace(np.min(xdat2), np.max(xdat2), num=1000)
yplot3 = mod3.eval(params=params3, x=xplot3)

params3.pretty_print()

mod4 = Model(poly3) 
params4 = Parameters() 
params4.add('a', value=0.000000, vary=True)
params4.add('b', value=0.00001, vary=True)
params4.add('c', value=0.0001, vary=True)
params4.add('d', value=0, vary=True)
params4.add('e', value=0, vary=True)
params4.add('f', value=0, vary=False)
params4.add('g', value=0, vary=False)

fit4 = mod4.fit(S_SZ2, params4, x=xdat3, weights=None, nfev=1e7)
params4.update(fit4.params)
xplot4= np.linspace(np.min(xdat3), np.max(xdat3), num=1000)
yplot4 = mod4.eval(params=params4, x=xplot4)

plt.figure() 
plt.scatter(xdat2, S_SZ1, s=3, c='b', label='S_Z / S_Z+1')
plt.plot(xplot3, yplot3, c='c')
plt.scatter(xdat3, S_SZ2, s=3, c='r', label='S_Z / S_Z+2')
plt.plot(xplot4, yplot4, c='tab:orange')
plt.ylabel('Nuclear sensitivity coefficient ratio [cm-1/fm]')
plt.legend()
plt.xlabel('Z')
plt.minorticks_on()
plt.show()
plt.close()

# plt.figure() 
# plt.scatter(xIC, yuncIC, s=3, c='tab:orange', label='Total theoretical uncertainty')
# plt.scatter(xIC, nonnucuncIC, s=3, c='b', label='Non-nuclear contribution')
# plt.plot(xplot, yplot, c='r')
# plt.scatter(xIC, nucuncIC, s=3, c='g', label='Nuclear contribution')
# #plt.errorbar(xdat, ydat, yerr=yunc, ls='none')
# plt.legend()
# #plt.ylabel('D1 Transition Energy [cm-1]')
# #plt.ylabel('Non-nuclear Theoretical Uncertainty[cm-1]')
# plt.ylabel('D1 transition energy uncertainty [cm-1]')
# plt.xlabel('Z')
# plt.minorticks_on()
# plt.show()
# plt.close() 